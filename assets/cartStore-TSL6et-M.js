import{k as u,l as s}from"./index-rQ1ecwA4.js";import{a as p,l as f,S as i}from"./alertStore-FvkRcQaP.js";var h={VITE_URL:"https://ec-course-api.hexschool.io/v2",VITE_PATH:"jiayu",BASE_URL:"/2023-vue-week6/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_URL:o,VITE_PATH:c}=h,{miniSwal:d,confirmSwal:n}=p(),{loadingStatus:e,hideLoading:m}=f(),y=u("cartStore",{state:()=>({cart:{},timer:0}),actions:{async getCart(){try{const t=`${o}/api/${c}/cart`,{data:a}=await s.get(t);this.cart=a.data}catch(t){i.fire(t.data.message||"發生錯誤")}finally{m()}},async postCart(t,a=1){try{e.productId=t;const r=`${o}/api/${c}/cart`,l={product_id:t,qty:a};await s.post(r,{data:l}),d("加入購物車"),this.getCart(),e.productId=""}catch(r){i.fire(r.data.message||"發生錯誤")}},async putCart(t){try{e.cartId=t.id;const a=`${o}/api/${c}/cart/${t.id}`,r={product_id:t.product_id,qty:t.qty};await s.put(a,{data:r}),this.getCart(),e.cartId=""}catch(a){i.fire(a.data.message||"發生錯誤")}},debouncePutCart(t){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.putCart(t)},300)},async delCart(t){try{if((await n(`確定刪除 ${t.product.title} ？`)).isConfirmed){e.cartId=t.id;const r=`${o}/api/${c}/cart/${t.id}`;await s.delete(r),d(`已刪除 ${t.product.title}`),this.getCart(),e.cartId=""}}catch(a){i.fire(a.data.message||"發生錯誤")}},async delAllCart(){try{if((await n("確認要清空購物車嗎？")).isConfirmed){const a=`${o}/api/${c}/carts`;await s.delete(a),d("已清空購物車"),this.getCart()}}catch(t){i.fire(t.data.message||"發生錯誤")}}}});export{y as c};
